#pragma once

#define PEDOLL_VERSION_INFO					"PeDoll Monitor v1.x"

#define PEDOLL_EXECUTE_REGULAR_NAME_LEN		256
#define PEDOLL_EXECUTE_REGULAR_CMD_LEN		256
#define PEDOLL_STACK_MEMORY_LEN				1024
#define PEDOLL_DUMP_MEMORY_LEN				1024
#define PEDOLL_MEMORY_LEN					1024
#define PEDOLL_DUMP_INFO_LEN				32

#define PEDOLL_CMD_MAGICNUMBER				0x31415926
#define PEDOLL_DUMP_MAGICNUMBER				0x31415927
#define PEDOLL_MESSAGE_MAGICNUMBER			0x31415928
#define PEDOLL_ACK_MAGICNUMBER				0x31415929
#define PEDOLL_APIACK_MAGICNUMBER			0x3141592a
#define PEDOLL_HOOKINFO_MAGICNUMBER			0x3141592b
#define PEDOLL_ACK_MEMORY					0x3141592c

#define PEDOLL_DOLL_NETWORK_PORT			31415
#define PEDOLL_CONTROLLER_NETWORK_PORT		31416
#define PEDOLL_NOTICE_YES					0
#define PEDOLL_NOTICE_NO	    			1

#define PEDOLL_EXECUTE_PASS					0
#define PEDOLL_EXECUTE_REJECT				1
#define PEDOLL_EXECUTE_TERMINATE			2

#define PEDOLL_HOOKMESSAGE_MAXLEN	PEDOLL_EXECUTE_REGULAR_NAME_LEN

#define PEDOLL_CONTROLLER_CMD_DOLL_IMPORTTABLE				1	
#define PEDOLL_CONTROLLER_CMD_DOLL_BININJECT				2	
#define PEDOLL_CONTROLLER_CMD_DOLL_DLLINJECT				3
#define PEDOLL_CONTROLLER_CMD_DOLL_DEBUG					5
#define PEDOLL_CONTROLLER_CMD_DOLL_ACTIVATEINJECT			6
#define PEDOLL_CONTROLLER_HOOKREPLY 						4

#define PEDOLL_CONTROLLER_CMD_DOLL_IMPORTTABLE_STR			"iti"	
#define PEDOLL_CONTROLLER_CMD_DOLL_BININJECT_STR			"bi"	
#define PEDOLL_CONTROLLER_CMD_DOLL_DLLINJECT_STR			"di"
#define PEDOLL_CONTROLLER_CMD_DOLL_DEBUG_STR				"db"
#define PEDOLL_CONTROLLER_CMD_DOLL_ACTIVATEINJECT_STR		"ac"
#define PEDOLL_CONTROLLER_PROCESSNAME_STR					"PROC"
#define PEDOLL_CONTROLLER_HOOKREPLY_STR						"hookreply"

#define PEDOLL_CONTROLLER_CMD_DOLL							"doll"
#define PEDOLL_CONTROLLER_CMD_SHELL							"shell"
#define PEDOLL_CONTROLLER_CMD_ENUMPROCESSES					"enumprocess"
#define PEDOLL_CONTROLLER_CMD_LS							"ls"
#define PEDOLL_CONTROLLER_CMD_KILL							"kill"


#define PEDOLL_DOOL_CMD_HOOK_STR							"hook"
#define PEDOLL_DOOL_CMD_UNHOOK_STR							"unhook"
#define PEDOLL_DOOL_CMD_TERMINATE_STR						"terminate"
#define PEDOLL_DOOL_CMD_RUN_STR								"run"
#define PEDOLL_DOLL_CMD_READESP_STR							"readesp"
#define PEDOLL_DOLL_CMD_READ_MEMORY_STR						"readmemory"
#define PEDOLL_DOLL_CMD_READ_LARGE_MEMORY_STR				"readlargememory"
#define PEDOLL_DOLL_CMD_HOOK_BIN_STR						"binary"
#define PEDOLL_DOLL_CMD_HOOK_UNBIN_STR						"unbinary"
#define PEDOLL_PARSER_FILTER_START_STR						"FILTER_START"


#define PEDOLL_QUERY_REGOPENKEYA				"REGOPENKEYA" 
#define PEDOLL_QUERY_REGOPENKEYEXA				"REGOPENKEYEXA" 
#define PEDOLL_QUERY_REGOPENKEYEXW				"REGOPENKEYEXW" 
#define PEDOLL_QUERY_REGQUERYVALUEEXA			"REGQUERYVALUEEXA"
#define PEDOLL_QUERY_REGQUERYVALUEEXW			"REGQUERYVALUEEXW"
#define PEDOLL_QUERY_REGSETKEYVALUEA			"REGSETKEYVALUEA"
#define PEDOLL_QUERY_REGSETVALUEEXW				"REGSETVALUEEXW"
#define PEDOLL_QUERY_REGSETVALUEEXA				"REGSETVALUEEXA"
#define PEDOLL_QUERY_REGSETVALUEA				"REGSETVALUEA"
#define PEDOLL_QUERY_REGCREATEKEYA				"REGCREATEKEYA"
#define PEDOLL_QUERY_FINDWINDOWEXA				"FINDWINDOWEXA"
#define PEDOLL_QUERY_FINDWINDOWEXW				"FINDWINDOWEXW"
#define PEDOLL_QUERY_LFINDWINDOWEXW				L"FINDWINDOWEXW"
#define PEDOLL_QUERY_REGCREATEKEYEXW			"REGCREATEKEYEXW"
#define PEDOLL_QUERY_REGCREATEKEYEXA			"REGCREATEKEYEXA"
#define PEDOLL_QUERY_CREATEFILEA				"CREATEFILEA"
#define PEDOLL_QUERY_CREATEFILEW				"CREATEFILEW"
#define PEDOLL_QUERY_WRITEFILE					"WRITEFILE"
#define PEDOLL_QUERY_WRITEPROCESSMEMORY			"WRITEPROCESSMEMORY"
#define PEDOLL_QUERY_DEVICEIOCONTROL			"DEVICEIOCONTROL"
#define PEDOLL_QUERY_WRITEFILEEX			    "WRITEFILEEX"
#define PEDOLL_QUERY_CREATEPROCESSINTERNALW		"CREATEPROCESSINTERNALW"
#define PEDOLL_QUERY_CREATEPROCESSW				"CREATEPROCESSW"
#define PEDOLL_QUERY_LCREATEPROCESSINTERNALW	L"CREATEPROCESSINTERNALW"
#define PEDOLL_QUERY_LCREATEPROCESSW			L"CREATEPROCESSW"
#define PEDOLL_QUERY_SETWINDOWTEXTW				"SETWINDOWTEXTW"
#define PEDOLL_QUERY_SETWINDOWTEXTA				"SETWINDOWTEXTA"
#define PEDOLL_QUERY_MESSAGEBOXA				"MESSAGEBOXA"
#define PEDOLL_QUERY_MESSAGEBOXW				"MESSAGEBOXW"

#define PEDOLL_QUERY_CREATEPROCESSA				"CREATEPROCESSA"
#define PEDOLL_QUERY_CONNECT					"CONNECT"
#define PEDOLL_QUERY_SEND						"SEND"
#define PEDOLL_QUERY_SENDTO						"SENDTO"
#define PEDOLL_QUERY_RECV						"RECV"
#define PEDOLL_QUERY_RECVFROM					"RECVFROM"
#define PEDOLL_QUERY_DELETEFILEA				"DELETEFILEA"
#define PEDOLL_QUERY_DELETEFILEW				"DELETEFILEW"
#define PEDOLL_QUERY_EXITWINDOWSEX				"EXITWINDOWSEX"
#define PEDOLL_QUERY_TERMINATEPROCESS			"TERMINATEPROCESS"
#define PEDOLL_QUERY_PROCESS32FIRSTW			"PROCESS32FIRSTW"
#define PEDOLL_QUERY_PROCESS32NEXTW				"PROCESS32NEXTW"
#define PEDOLL_QUERY_OPENPROCESS				"OPENPROCESS"
#define PEDOLL_QUERY_LOADLIBRARYEXW				"LOADLIBRARYEXW"
#define PEDOLL_QUERY_CREATEWINDOWEXW			"CREATEWINDOWEXW"
#define PEDOLL_QUERY_SETWINDOWPOS				"SETWINDOWPOS"
#define PEDOLL_QUERY_SETFILEATTRIBUTESA			"SETFILEATTRIBUTESA"
#define PEDOLL_QUERY_SETFILEATTRIBUTESW			"SETFILEATTRIBUTESW"

#define PEDOLL_DOOL_CMD_HOOK					1
#define PEDOLL_DOOL_CMD_UNHOOK					2
#define PEDOLL_DOOL_CMD_TERMINATE				3
#define PEDOLL_PARSER_FILTER_START				4
#define PEDOLL_DOOL_CMD_RUN						5


#define GRAMMAR_TOKEN_DOLL						6
#define GRAMMAR_TOKEN_SHELL						7
#define GRAMMAR_TOKEN_ENUMPROCESSES				8
#define GRAMMAR_TOKEN_LS						9
#define GRAMMAR_TOKEN_KILL						10
#define PEDOLL_DOOL_CMD_READESP					11
#define PEDOLL_DOOL_CMD_READMEMORY				12
#define PEDOLL_DOOL_CMD_BINARY  				13
#define PEDOLL_DOOL_CMD_UNBINARY  				14
struct PEDOLL_MESSAGE_PACKET
{
	unsigned int MagicNumber;
	char Messages[PEDOLL_EXECUTE_REGULAR_NAME_LEN];
	PEDOLL_MESSAGE_PACKET()
	{
		MagicNumber=PEDOLL_MESSAGE_MAGICNUMBER;
		memset(Messages,0,PEDOLL_EXECUTE_REGULAR_NAME_LEN);
	}
};


struct PEDOLL_HOOKINFO_PACKET
{
	unsigned int MagicNumber;
	unsigned int PacketID;
	unsigned int esp;
	char APIInfo[PEDOLL_EXECUTE_REGULAR_NAME_LEN];
	PEDOLL_HOOKINFO_PACKET()
	{
		esp=0;
		PacketID=0;
		MagicNumber=PEDOLL_HOOKINFO_MAGICNUMBER;
		memset(APIInfo,0,PEDOLL_EXECUTE_REGULAR_NAME_LEN);
	}
};

struct PEDOLL_DUMP_PACKET_HEADER
{
	unsigned int MagicNumber;
	char		 DestInfo[PEDOLL_DUMP_INFO_LEN];
	PEDOLL_DUMP_PACKET_HEADER()
	{
		MagicNumber=PEDOLL_DUMP_MAGICNUMBER;
	}
};


struct PEDOLL_COMMAND_PACKET
{
	unsigned int MagicNumber;
	char		 Info[PEDOLL_EXECUTE_REGULAR_CMD_LEN];
	PEDOLL_COMMAND_PACKET()
	{
		MagicNumber=PEDOLL_CMD_MAGICNUMBER;
	}
};

struct PEDOLL_API_ACK
{
	unsigned int MagicNumber;
	unsigned int PacketID;
	unsigned int Exec;
	PEDOLL_API_ACK()
	{
		MagicNumber=PEDOLL_APIACK_MAGICNUMBER;
	}
};

struct PEDOLL_ACK_PACKET
{
	unsigned int MagicNumber;
	unsigned int Return;
	PEDOLL_ACK_PACKET()
	{
		MagicNumber=PEDOLL_ACK_MAGICNUMBER;
		Return=0;
	}
};

struct PEDOLL_MEMORY_ACK_PACKET
{
	unsigned int MagicNumber;
	unsigned int Address;
	int			 size;
	char		 buffer[PEDOLL_STACK_MEMORY_LEN];
	PEDOLL_MEMORY_ACK_PACKET()
	{
		size=0;
		MagicNumber=PEDOLL_ACK_MEMORY;
	}
};